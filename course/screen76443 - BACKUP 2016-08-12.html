<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Final Assessment Results</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 25px;
      background: #ffffff;
    }

    .results-container {
      max-width: 800px;
      border: 1px solid #ccc;
      padding: 20px;
      background: #f9f9f9;
    }

    h2 {
      margin-top: 0;
    }

    .score {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .feedback {
      font-weight: bold;
      margin-top: 15px;
    }

    .passed {
      color: green;
    }

    .failed {
      color: red;
    }

    ul {
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <div class="results-container">
    <h2>Final Assessment Results</h2>

    <div class="score">Your score: <span id="divScore">0</span>%</div>

    <div id="feedback" class="feedback"></div>

    <h3>Question Review:</h3>
    <div id="review"></div>
  </div>

  <script>
    // --- CUSTOM SCORING LOGIC ---
    const totalQuestions = 5; // Update this to match total number of questions
    let correctCount = 0;
    let reviewHtml = "";

    // Question 1 - COVID Transmission (multiple)
    const q1 = JSON.parse(localStorage.getItem("q1") || "[]");
    const q1Correct = ["Close contact", "Air-borne droplets", "Blood"];
    const q1CorrectBool = q1.length === q1Correct.length && q1.sort().toString() === q1Correct.sort().toString();
    if (q1CorrectBool) correctCount++;
    reviewHtml += "<p><strong>Q1:</strong> COVID-19 transmission<br> Your answer: " + q1.join(", ") + "<br>" +
      (q1CorrectBool ? "✅ Correct" : "❌ Incorrect. Correct: " + q1Correct.join(", ")) + "</p>";

    // Question 2 - Mask reuse (single)
    const q2 = localStorage.getItem("q2");
    const q2Correct = "false";
    const q2CorrectBool = q2 === q2Correct;
    if (q2CorrectBool) correctCount++;
    reviewHtml += "<p><strong>Q2:</strong> Mask reuse<br> Your answer: " + q2 + "<br>" +
      (q2CorrectBool ? "✅ Correct" : "❌ Incorrect. Correct: " + q2Correct) + "</p>";

    // Question 3 - Handwashing (single)
    const q3 = localStorage.getItem("q3");
    const q3Correct = "false";
    const q3CorrectBool = q3 === q3Correct;
    if (q3CorrectBool) correctCount++;
    reviewHtml += "<p><strong>Q3:</strong> Handwashing<br> Your answer: " + q3 + "<br>" +
      (q3CorrectBool ? "✅ Correct" : "❌ Incorrect. Correct: " + q3Correct) + "</p>";

    // Question 4 - Alternatives to soap (multiple)
    const q4 = JSON.parse(localStorage.getItem("q4") || "[]");
    const q4Correct = ["Ash", "Hydro-alcoholic solution"];
    const q4CorrectBool = q4.length === q4Correct.length && q4.sort().toString() === q4Correct.sort().toString();
    if (q4CorrectBool) correctCount++;
    reviewHtml += "<p><strong>Q4:</strong> Alternatives to soap<br> Your answer: " + q4.join(", ") + "<br>" +
      (q4CorrectBool ? "✅ Correct" : "❌ Incorrect. Correct: " + q4Correct.join(", ")) + "</p>";

    // Question 5 - Follow-up First Aid (single)
    const q5 = localStorage.getItem("firstAid_followUp");
    const q5Correct = "defibrillator";
    const q5CorrectBool = q5 === q5Correct;
    if (q5CorrectBool) correctCount++;
    reviewHtml += "<p><strong>Q5:</strong> Follow-up First Aid<br> Your answer: " + q5 + "<br>" +
      (q5CorrectBool ? "✅ Correct" : "❌ Incorrect. Correct: " + q5Correct) + "</p>";

    // Calculate final score
    const scorePercent = Math.round((correctCount / totalQuestions) * 100);
    document.getElementById("divScore").textContent = scorePercent;
    document.getElementById("review").innerHTML = reviewHtml;

    // Feedback message
    const passingScore = 70; // Adjust passing %
    const feedbackDiv = document.getElementById("feedback");
    if (scorePercent >= passingScore) {
      feedbackDiv.textContent = "Great job! You passed the course.";
      feedbackDiv.className = "feedback passed";
    } else {
      feedbackDiv.textContent = "Sorry, you did not achieve the minimum score of " + passingScore + "%.";
      feedbackDiv.className = "feedback failed";
    }
  </script>
</body>
</html>
